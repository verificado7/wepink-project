<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>wepink :: Admin</title>
  <meta name="description" content="Painel de Administração - Wepink">
  <meta name="copyright" content="WePink">
  <meta name="author" content="WePink">
  <meta name="country" content="BRA">
  <meta name="language" content="pt-BR">
  <link rel="icon" href="/img/we.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #f5f5f5 0%, #e0e7ff 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .admin-panel {
      max-width: 1400px;
      width: 100%;
      margin: 20px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      overflow: hidden;
      display: none;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .admin-header {
      background: linear-gradient(90deg, #ff2e82, #ff99cc);
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      position: relative;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }

    .logout-button {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #fff;
      color: #ff2e82;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .logout-button:hover {
      background: #ff2e82;
      color: #fff;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .admin-content {
      padding: 20px;
    }

    .dashboard-summary {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .summary-card {
      flex: 1;
      background: linear-gradient(145deg, #f9f9f9, #fff);
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
      min-width: 200px;
    }

    .summary-card h3 {
      color: #ff2e82;
      font-size: 1.1rem;
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .summary-card p {
      font-size: 1.2rem;
      font-weight: bold;
      color: #333;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .section-header h2 {
      color: #ff2e82;
      font-size: 1.2rem;
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .section-header .button-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .section-header button {
      background: linear-gradient(90deg, #ff2e82, #ff99cc);
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      text-transform: uppercase;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .section-header button:hover {
      background: linear-gradient(90deg, #e02974, #ff80b3);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    }

    .section-header select {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 0.9rem;
      background: #f9f9f9;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .section-header select:focus {
      border-color: #ff2e82;
      box-shadow: 0 0 8px rgba(255,46,130,0.3);
      outline: none;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .table th, .table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    .table th {
      background: linear-gradient(90deg, #ff99cc, #ff80b3);
      color: #fff;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 0.9rem;
    }

    .table td {
      font-size: 0.85rem;
      color: #333;
      transition: background 0.3s ease;
    }

    .table tr:hover td {
      background: #f9f9f9;
    }

    .table button {
      background: linear-gradient(90deg, #ff2e82, #ff99cc);
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-right: 5px;
    }

    .table button:hover {
      background: linear-gradient(90deg, #e02974, #ff80b3);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .order-items p, .address-details p, .payment-details p {
      font-size: 0.85rem;
      color: #666;
      margin: 3px 0;
    }

    .payment-details code {
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.85rem;
      color: #ff2e82;
      word-break: break-all;
      display: block;
      background: #f9f9f9;
      padding: 5px;
      border-radius: 4px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      animation: fadeIn 0.3s ease-in-out;
    }

    .modal-content {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      width: 90%;
      max-width: 600px;
      position: relative;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      animation: slideIn 0.3s ease;
      max-height: 80vh;
      overflow-y: auto;
      border-top: 4px solid #ff2e82;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content h3 {
      color: #ff2e82;
      font-size: 1.3rem;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .modal-content label {
      display: block;
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .modal-content input, .modal-content textarea, .modal-content select {
      width: 100%;
      padding: 12px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 0.9rem;
      background: #f9f9fb;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    }

    .modal-content input:focus, .modal-content textarea:focus, .modal-content select:focus {
      border-color: #ff2e82;
      background: #fff;
      box-shadow: 0 0 8px rgba(255,46,130,0.3);
      outline: none;
    }

    .modal-content input.invalid {
      border-color: #ff2e82;
      background: #fff2f4;
    }

    .modal-content .delivery-fees {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    .modal-content .delivery-fees div {
      flex: 1;
    }

    .modal-content img {
      width: 100px;
      height: auto;
      margin-bottom: 10px;
      display: none;
      border-radius: 8px;
    }

    .modal-content button {
      background: linear-gradient(90deg, #ff2e82, #ff99cc);
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9rem;
      width: 100%;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .modal-content button:hover {
      background: linear-gradient(90deg, #e02974, #ff80b3);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
      transition: color 0.3s ease;
    }

    .close-modal:hover {
      color: #ff2e82;
    }

    .error-message {
      color: #ff2e82;
      font-size: 0.8rem;
      margin: 5px 0;
      display: none;
      background: #fff2f4;
      padding: 4px 8px;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .error-message.visible {
      display: block;
    }

    .login-screen {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      text-align: center;
      max-width: 400px;
      width: 100%;
      animation: fadeIn 0.5s ease;
      border-top: 4px solid #ff2e82;
    }

    .login-screen h2 {
      color: #ff2e82;
      font-size: 1.5rem;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }

    .login-screen input {
      width: 100%;
      padding: 12px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 0.9rem;
      background: #f9f9fb;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    }

    .login-screen input:focus {
      border-color: #ff2e82;
      background: #fff;
      box-shadow: 0 0 8px rgba(255,46,130,0.3);
      outline: none;
    }

    .login-screen button {
      background: linear-gradient(90deg, #ff2e82, #ff99cc);
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9rem;
      width: 100%;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .login-screen button:hover {
      background: linear-gradient(90deg, #e02974, #ff80b3);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    }

    .login-screen .error-message {
      display: block;
    }

    @media (max-width: 600px) {
      .admin-panel {
        margin: 10px;
      }

      .admin-header {
        font-size: 1.2rem;
      }

      .logout-button {
        padding: 6px 12px;
        font-size: 0.8rem;
      }

      .dashboard-summary {
        flex-direction: column;
      }

      .summary-card {
        min-width: 100%;
      }

      .section-header h2 {
        font-size: 1rem;
      }

      .section-header button, .section-header select {
        font-size: 0.8rem;
        padding: 8px 15px;
      }

      .table th, .table td {
        font-size: 0.8rem;
        padding: 8px;
      }

      .order-items p, .address-details p, .payment-details p {
        font-size: 0.75rem;
      }

      .modal-content {
        width: 95%;
        padding: 15px;
      }

      .modal-content h3 {
        font-size: 1rem;
      }

      .modal-content input, .modal-content textarea, .modal-content select {
        font-size: 0.8rem;
      }

      .modal-content .delivery-fees {
        flex-direction: column;
        gap: 5px;
      }

      .modal-content button {
        font-size: 0.8rem;
      }

      .login-screen {
        margin: 10px;
      }

      .login-screen h2 {
        font-size: 1.2rem;
      }

      .login-screen input, .login-screen button {
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <!-- Tela de Login -->
  <div class="login-screen" id="login-screen">
    <h2>Acesso ao Painel de Administração</h2>
    <input type="password" id="admin-password" placeholder="Digite a senha" aria-label="Senha de administrador">
    <p class="error-message" id="error-password"></p>
    <button onclick="checkPassword()">Entrar</button>
  </div>

  <!-- Painel de Administração -->
  <div class="admin-panel" id="admin-panel">
    <!-- Cabeçalho -->
    <div class="admin-header">
      Admin - Wepink
      <button class="logout-button" onclick="logout()" aria-label="Sair do painel de administração">Sair</button>
    </div>

    <!-- Conteúdo -->
    <div class="admin-content">
      <!-- Resumo Financeiro -->
      <div class="dashboard-summary">
        <div class="summary-card">
          <h3>Total de Vendas</h3>
          <p id="total-sales">R$ 0,00</p>
        </div>
        <div class="summary-card">
          <h3>Total via Pix</h3>
          <p id="total-pix-sales">R$ 0,00</p>
        </div>
        <div class="summary-card">
          <h3>Total via Cartão</h3>
          <p id="total-card-sales">R$ 0,00</p>
        </div>
        <div class="summary-card">
          <h3>Pedidos Pendentes</h3>
          <p id="pending-orders">0</p>
        </div>
        <div class="summary-card">
          <h3>Pedidos Concluídos</h3>
          <p id="completed-orders">0</p>
        </div>
      </div>

      <!-- Seção de Pedidos -->
      <div class="section-header">
        <h2>Pedidos</h2>
        <div class="button-group">
          <select id="filter-status" onchange="updateOrderList()" aria-label="Filtrar por status">
            <option value="all">Todos os Status</option>
            <option value="Gerado">Gerado (Pix)</option>
            <option value="Efetuado">Efetuado</option>
            <option value="Pendente">Pendente</option>
          </select>
          <select id="filter-method" onchange="updateOrderList()" aria-label="Filtrar por método de pagamento">
            <option value="all">Todos os Métodos</option>
            <option value="Pix">Pix</option>
            <option value="Cartão">Cartão</option>
          </select>
          <button onclick="openModal('add-product-modal')" aria-label="Adicionar novo produto"><i class="fas fa-box"></i> Adicionar Produto</button>
          <button onclick="openModal('add-client-modal')" aria-label="Adicionar novo cliente"><i class="fas fa-user-plus"></i> Adicionar Cliente</button>
          <button onclick="exportData()" aria-label="Exportar dados"><i class="fas fa-download"></i> Exportar Dados</button>
          <button onclick="document.getElementById('import-data-file').click()" aria-label="Importar dados"><i class="fas fa-upload"></i> Importar Dados</button>
          <input type="file" id="import-data-file" style="display: none;" accept=".json" onchange="importData(event)">
        </div>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Nº do Pedido</th>
            <th>Cliente (E-mail)</th>
            <th>Produtos</th>
            <th>Endereço</th>
            <th>Total</th>
            <th>Pagamento</th>
            <th>Data do Pedido</th>
            <th>Status</th>
            <th>Ação</th>
          </tr>
        </thead>
        <tbody id="order-list">
          <!-- Pedidos serão adicionados dinamicamente aqui -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Modal para Adicionar Produto -->
  <div class="modal" id="add-product-modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal('add-product-modal')" aria-label="Fechar modal">×</span>
      <h3>Adicionar Novo Produto</h3>
      <label for="product-name">Nome do Produto</label>
      <input type="text" id="product-name" placeholder="Ex.: One Touch Silk Desodorante Colônia 100ml - Wepink" aria-label="Nome do produto">
      <p class="error-message" id="error-product-name"></p>
      <label for="product-description">Descrição Curta</label>
      <input type="text" id="product-description" placeholder="Ex.: exale delicadeza e doçura com um toque que encanta" aria-label="Descrição curta do produto">
      <p class="error-message" id="error-product-description"></p>
      <label for="product-full-description">Descrição Completa</label>
      <textarea id="product-full-description" placeholder="Ex.: Sinta um toque delicado de carinho com o Desodorante Colônia Wepink..." aria-label="Descrição completa do produto"></textarea>
      <p class="error-message" id="error-product-full-description"></p>
      <label for="product-notes">Notas (separadas por <br>)</label>
      <input type="text" id="product-notes" placeholder="Ex.: Notas de topo: Bergamota e Morango<br>Notas de coração: Floral<br>Notas de fundo: Baunilha" aria-label="Notas olfativas do produto">
      <p class="error-message" id="error-product-notes"></p>
      <label for="product-price-total">Preço Total (R$)</label>
      <input type="number" id="product-price-total" step="0.01" placeholder="Ex.: 329.00" aria-label="Preço total do produto">
      <p class="error-message" id="error-product-price-total"></p>
      <label for="product-price-new">Preço Promocional (R$)</label>
      <input type="number" id="product-price-new" step="0.01" placeholder="Ex.: 115.15" aria-label="Preço promocional do produto">
      <p class="error-message" id="error-product-price-new"></p>
      <label>Taxas de Entrega (R$)</label>
      <div class="delivery-fees">
        <div>
          <label for="product-delivery-option1">Opção 1</label>
          <input type="number" id="product-delivery-option1" step="0.01" placeholder="Ex.: 3.00" aria-label="Taxa de entrega opção 1">
          <p class="error-message" id="error-product-delivery-option1"></p>
        </div>
        <div>
          <label for="product-delivery-option2">Opção 2</label>
          <input type="number" id="product-delivery-option2" step="0.01" placeholder="Ex.: 4.00" aria-label="Taxa de entrega opção 2">
          <p class="error-message" id="error-product-delivery-option2"></p>
        </div>
      </div>
      <label for="product-image-file">Imagem (PNG)</label>
      <input type="file" id="product-image-file" accept="image/png" aria-label="Selecionar imagem do produto">
      <p class="error-message" id="error-product-image-file"></p>
      <img id="product-image-preview" alt="Prévia da Imagem">
      <button onclick="addProduct()" aria-label="Adicionar produto">Adicionar</button>
    </div>
  </div>

  <!-- Modal para Adicionar Cliente -->
  <div class="modal" id="add-client-modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal('add-client-modal')" aria-label="Fechar modal">×</span>
      <h3>Adicionar Novo Cliente</h3>
      <label for="client-name">Nome</label>
      <input type="text" id="client-name" placeholder="Ex.: Ana Silva" aria-label="Nome do cliente">
      <p class="error-message" id="error-client-name"></p>
      <label for="client-email">E-mail</label>
      <input type="email" id="client-email" placeholder="Ex.: ana.silva@email.com" aria-label="E-mail do cliente">
      <p class="error-message" id="error-client-email"></p>
      <label for="client-phone">Telefone</label>
      <input type="text" id="client-phone" placeholder="Ex.: (11) 98765-4321" aria-label="Telefone do cliente">
      <p class="error-message" id="error-client-phone"></p>
      <label for="client-address">Endereço</label>
      <input type="text" id="client-address" placeholder="Ex.: Rua das Flores, 123, São Paulo, SP" aria-label="Endereço do cliente">
      <p class="error-message" id="error-client-address"></p>
      <label for="client-purchases">Compras Realizadas</label>
      <input type="text" id="client-purchases" placeholder="Ex.: 3 pedidos" aria-label="Compras realizadas pelo cliente">
      <p class="error-message" id="error-client-purchases"></p>
      <button onclick="addClient()" aria-label="Adicionar cliente">Adicionar</button>
    </div>
  </div>

  <!-- Modal para Editar Pedido -->
  <div class="modal" id="edit-order-modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal('edit-order-modal')" aria-label="Fechar modal">×</span>
      <h3>Editar Pedido</h3>
      <input type="hidden" id="edit-order-index">
      <label for="edit-order-status">Status</label>
      <select id="edit-order-status" aria-label="Selecionar status do pedido">
        <option value="Gerado">Gerado (Pix)</option>
        <option value="Efetuado">Efetuado</option>
        <option value="Pendente">Pendente</option>
      </select>
      <button onclick="saveOrderChanges()" aria-label="Salvar alterações do pedido">Salvar Alterações</button>
    </div>
  </div>

  <script>
    // Senha fixa para acesso ao painel
    const ADMIN_PASSWORD = "admin123";

    // Função para verificar a senha
    function checkPassword() {
      const passwordInput = document.getElementById('admin-password').value;
      const errorMessage = document.getElementById('error-password');
      if (passwordInput === ADMIN_PASSWORD) {
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('admin-panel').style.display = 'block';
        updateOrderList();
        updateSummary();
      } else {
        errorMessage.textContent = 'Senha incorreta. Tente novamente.';
        errorMessage.classList.add('visible');
        document.getElementById('admin-password').value = '';
      }
    }

    // Função para logout
    function logout() {
      document.getElementById('admin-panel').style.display = 'none';
      document.getElementById('login-screen').style.display = 'block';
      document.getElementById('admin-password').value = '';
      document.getElementById('error-password').classList.remove('visible');
    }

    // Dados iniciais dos produtos (sincronizados com payment.html)
    let initialProducts = [
      {
        id: "onetouch",
        name: "One Touch Silk Desodorante Colônia 100ml - Wepink",
        description: "exale delicadeza e doçura com um toque que encanta",
        fullDescription: "Sinta um toque delicado de carinho com o Desodorante Colônia Wepink One Touch Silk, um aroma alegre que revive a essência de um romance. Sua fragrância Floral e Frutada inicia no charme da Bergamota e no frescor do Morango, evoluindo em um coração floral encantador. Finaliza em um fundo doce e suave de Baunilha, florescendo a essência feminina inesquecível.",
        notes: "Notas de topo: Bergamota e Morango<br>Notas de coração: Floral<br>Notas de fundo: Baunilha",
        priceOld: 1000.00,
        priceNew: 350.00,
        installmentsPerUnit: 58.33,
        image: "/img/onetouch.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "liberte",
        name: "Liberté Desodorante Colônia 100ml - Wepink",
        description: "Transborde a sua essência mais nobre.",
        fullDescription: "Liberté Desodorante Colônia Wepink é uma fragrância que reflete liberdade e sofisticação. Com notas florais orientais, inicia com um toque cítrico de Mandarina e Pêra, evoluindo para um coração de Jasmim e Flor de Laranjeira, e finalizando com um fundo quente de Âmbar e Baunilha, criando uma essência marcante e inesquecível.",
        notes: "Notas de topo: Mandarina e Pêra<br>Notas de coração: Jasmim e Flor de Laranjeira<br>Notas de fundo: Âmbar e Baunilha",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/liberte.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "golden",
        name: "VF Golden Desodorante Colônia 75ml - Wepink",
        description: "Fragrância preciosa que transforma momentos em ouro.",
        fullDescription: "VF Golden Desodorante Colônia Wepink é uma fragrância que evoca luxo e sofisticação. Com um caminho olfativo Âmbar Floral, inicia com notas de Pêssego e Maçã, passa por um coração floral de Rosa e Jasmim, e finaliza com um fundo rico de Âmbar e Sândalo, transformando cada momento em uma experiência dourada.",
        notes: "Notas de topo: Pêssego e Maçã<br>Notas de coração: Rosa e Jasmim<br>Notas de fundo: Âmbar e Sândalo",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/golden.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "obsessed",
        name: "Obsessed Desodorante Colônia 100ml - Wepink",
        description: "A elegância do mistério em uma essência única.",
        fullDescription: "Obsessed Desodorante Colônia Wepink é uma fragrância que captura o mistério e a elegância. Com um caminho olfativo Oriental Amadeirado, inicia com notas de Cardamomo e Pimenta Rosa, evolui para um coração de Lavanda e Gerânio, e finaliza com um fundo profundo de Patchouli e Âmbar, criando uma essência envolvente e inesquecível.",
        notes: "Notas de topo: Cardamomo e Pimenta Rosa<br>Notas de coração: Lavanda e Gerânio<br>Notas de fundo: Patchouli e Âmbar",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/obsessed.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "vf",
        name: "VF Bloom Desodorante Colônia 75ml - Wepink",
        description: "Beleza no sutil florescer do aroma.",
        fullDescription: "VF Bloom Desodorante Colônia Wepink é uma fragrância que celebra a beleza do florescer. Com um caminho olfativo Floral Cítrico, inicia com notas frescas de Limão Siciliano e Laranja, evolui para um coração de Peônia e Lírio, e finaliza com um fundo suave de Almíscar e Cedro, trazendo frescor e delicadeza a cada aplicação.",
        notes: "Notas de topo: Limão Siciliano e Laranja<br>Notas de coração: Peônia e Lírio<br>Notas de fundo: Almíscar e Cedro",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/vf.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "seduce",
        name: "VF Seduce Desodorante Colônia 75ml - Wepink",
        description: "Aura de magnetismo e sedução envolvente.",
        fullDescription: "VF Seduce Desodorante Colônia Wepink é uma fragrância que exala magnetismo e sedução. Com um caminho olfativo Floral Gourmand, inicia com notas doces de Caramelo e Framboesa, evolui para um coração de Rosa e Violeta, e finaliza com um fundo quente de Baunilha e Tonka, criando uma aura irresistível.",
        notes: "Notas de topo: Caramelo e Framboesa<br>Notas de coração: Rosa e Violeta<br>Notas de fundo: Baunilha e Tonka",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/seduce.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "therainy",
        name: "The Rainy Desodorante Colônia 75ml - Wepink",
        description: "Mergulhe na essência refrescante da natureza!",
        fullDescription: "The Rainy Desodorante Colônia Wepink traz a essência refrescante da natureza. Com um caminho olfativo Cítrico Aquático, inicia com notas de Limão e Notas Aquáticas, evolui para um coração de Menta e Jasmim, e finaliza com um fundo de Almíscar e Madeiras Brancas, trazendo uma sensação de frescor e serenidade.",
        notes: "Notas de topo: Limão e Notas Aquáticas<br>Notas de coração: Menta e Jasmim<br>Notas de fundo: Almíscar e Madeiras Brancas",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/therainy.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      },
      {
        id: "celebrate",
        name: "Celebrate Life Desodorante Colônia 100ml - Wepink",
        description: "Comemore a vida com um aroma extraordinário.",
        fullDescription: "Celebrate Life Desodorante Colônia Wepink é uma fragrância que celebra a alegria de viver. Com um caminho olfativo Frutado Gourmand, inicia com notas de Maçã e Cassis, evolui para um coração de Praliné e Jasmim, e finaliza com um fundo doce de Baunilha e Caramelo, trazendo uma explosão de felicidade em cada borrifada.",
        notes: "Notas de topo: Maçã e Cassis<br>Notas de coração: Praliné e Jasmim<br>Notas de fundo: Baunilha e Caramelo",
        priceOld: 329.00,
        priceNew: 115.15,
        installmentsPerUnit: 19.19,
        image: "/img/celebrate.png",
        deliveryFees: {
          sp: { option1: 3.00, option2: 4.00 },
          southeast: { option1: 5.00, option2: 6.00 },
          other: { option1: 7.00, option2: 8.00 }
        }
      }
    ];

    // Carregar produtos do localStorage ou usar a lista inicial
    let products = [];
    try {
      const storedProducts = JSON.parse(localStorage.getItem('wepink_products'));
      if (storedProducts && Array.isArray(storedProducts) && storedProducts.length > 0) {
        products = storedProducts;
        console.log('Produtos carregados do localStorage:', products);
      } else {
        products = initialProducts;
        localStorage.setItem('wepink_products', JSON.stringify(products));
        console.log('Produtos inicializados com initialProducts:', products);
      }
    } catch (error) {
      console.error('Erro ao carregar produtos do localStorage:', error);
      products = initialProducts;
      localStorage.setItem('wepink_products', JSON.stringify(products));
      console.log('Produtos inicializados com initialProducts após erro:', products);
    }

    // Carregar clientes do localStorage ou usar a lista inicial
    let initialClients = [
      {
        name: "Ana Silva",
        email: "ana.silva@email.com",
        phone: "(11) 98765-4321",
        address: "Rua das Flores, 123, São Paulo, SP",
        purchases: "3 pedidos"
      },
      {
        name: "Carlos Oliveira",
        email: "carlos.oliveira@email.com",
        phone: "(21) 91234-5678",
        address: "Av. Atlântica, 456, Rio de Janeiro, RJ",
        purchases: "5 pedidos"
      }
    ];
    let clients = [];
    try {
      const storedClients = JSON.parse(localStorage.getItem('wepink_clients'));
      clients = storedClients && Array.isArray(storedClients) ? storedClients : initialClients;
    } catch (error) {
      console.error('Erro ao carregar clientes do localStorage:', error);
      clients = initialClients;
    }

    // Função para formatar valores monetários
    function formatCurrency(value) {
      return `R$ ${parseFloat(value || 0).toFixed(2).replace('.', ',')}`;
    }

    // Função para formatar a data
    function formatDate(dateString) {
      const date = new Date(dateString);
      if (isNaN(date.getTime())) return 'Data inválida';
      return date.toLocaleString('pt-BR', { 
        day: '2-digit', 
        month: '2-digit', 
        year: 'numeric', 
        hour: '2-digit', 
        minute: '2-digit',
        second: '2-digit'
      });
    }

    // Função para formatar CPF
    function formatCPF(cpf) {
      if (!cpf) return 'Não informado';
      let value = cpf.replace(/\D/g, '').slice(0, 11);
      let formatted = '';
      for (let i = 0; i < value.length; i++) {
        if (i === 3 || i === 6) formatted += '.';
        if (i === 9) formatted += '-';
        formatted += value[i];
      }
      return formatted;
    }

    // Função para formatar número do cartão
    function formatCardNumber(cardNumber) {
      if (!cardNumber) return 'Não informado';
      let value = cardNumber.replace(/\D/g, '').slice(0, 16);
      let formatted = '';
      for (let i = 0; i < value.length; i++) {
        formatted += i > 0 && i % 4 === 0 ? ' ' + value[i] : value[i];
      }
      return formatted;
    }

    // Função para salvar produtos no localStorage
    function saveProducts() {
      try {
        localStorage.setItem('wepink_products', JSON.stringify(products));
        console.log('Produtos salvos no localStorage:', products);
      } catch (error) {
        console.error('Erro ao salvar produtos no localStorage:', error);
        alert('Erro ao salvar produtos. Verifique o console para mais detalhes.');
      }
    }

    // Função para salvar clientes no localStorage
    function saveClients() {
      try {
        localStorage.setItem('wepink_clients', JSON.stringify(clients));
        console.log('Clientes salvos no localStorage:', clients);
      } catch (error) {
        console.error('Erro ao salvar clientes no localStorage:', error);
        alert('Erro ao salvar clientes. Verifique o console para mais detalhes.');
      }
    }

    // Função para salvar pedidos (incluindo detalhes de pagamento)
    function saveOrders(orders) {
      try {
        localStorage.setItem('adminOrders', JSON.stringify(orders));
        console.log('Pedidos salvos no localStorage:', orders);
        updateOrderList();
        updateSummary();
      } catch (error) {
        console.error('Erro ao salvar pedidos no localStorage:', error);
        alert('Erro ao salvar pedidos. Verifique o console para mais detalhes.');
      }
    }

    // Função para exportar dados
    function exportData() {
      const data = {
        products: products,
        clients: clients,
        orders: JSON.parse(localStorage.getItem('adminOrders')) || []
      };
      const dataStr = JSON.stringify(data, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'wepink_data.json';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      alert('Dados exportados com sucesso!');
    }

    // Função para importar dados
    function importData(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const data = JSON.parse(e.target.result);
            if (data.products && Array.isArray(data.products)) {
              products = data.products;
              saveProducts();
            }
            if (data.clients && Array.isArray(data.clients)) {
              clients = data.clients;
              saveClients();
            }
            if (data.orders && Array.isArray(data.orders)) {
              saveOrders(data.orders);
            }
            alert('Dados importados com sucesso!');
          } catch (error) {
            alert('Erro ao importar dados: formato inválido.');
            console.error('Erro ao importar dados:', error);
          }
        };
        reader.readAsText(file);
      }
    }

    // Função para atualizar o resumo financeiro
    function updateSummary() {
      const adminOrders = JSON.parse(localStorage.getItem('adminOrders')) || [];
      let totalSales = 0;
      let totalPixSales = 0;
      let totalCardSales = 0;
      let pendingOrders = 0;
      let completedOrders = 0;

      adminOrders.forEach(order => {
        if (!order.purchaseData || !order.purchaseData.cartItems) return;

        let subtotal = 0;
        order.purchaseData.cartItems.forEach(item => {
          subtotal += (item.priceNew || 0) * (item.quantity || 1);
        });
        const deliveryFee = order.purchaseData.address?.deliveryFee || 0;
        const totalWithDelivery = subtotal + deliveryFee;
        totalSales += totalWithDelivery;

        const method = order.paymentMethod || 'Desconhecido';
        const status = order.status || 'Pendente';

        if (method === 'Pix') {
          totalPixSales += totalWithDelivery;
        } else if (method === 'Cartão') {
          totalCardSales += totalWithDelivery;
        }

        if (status === 'Gerado' || status === 'Pendente') {
          pendingOrders++;
        } else if (status === 'Efetuado') {
          completedOrders++;
        }
      });

      document.getElementById('total-sales').textContent = formatCurrency(totalSales);
      document.getElementById('total-pix-sales').textContent = formatCurrency(totalPixSales);
      document.getElementById('total-card-sales').textContent = formatCurrency(totalCardSales);
      document.getElementById('pending-orders').textContent = pendingOrders;
      document.getElementById('completed-orders').textContent = completedOrders;
    }

    // Função para atualizar a lista de pedidos
    function updateOrderList() {
      const adminOrders = JSON.parse(localStorage.getItem('adminOrders')) || [];
      const orderList = document.getElementById('order-list');
      const filterStatus = document.getElementById('filter-status').value;
      const filterMethod = document.getElementById('filter-method').value;
      orderList.innerHTML = '';

      if (adminOrders.length === 0) {
        orderList.innerHTML = '<tr><td colspan="9">Nenhum pedido registrado.</td></tr>';
        console.log('Nenhum pedido encontrado em adminOrders.');
        return;
      }

      console.log('Atualizando lista de pedidos:', adminOrders);
      adminOrders.forEach((order, index) => {
        if (!order.purchaseData || !order.purchaseData.cartItems || order.purchaseData.cartItems.length === 0) {
          console.warn(`Pedido #${index + 1} não possui itens válidos.`, order);
          return;
        }

        const method = order.paymentMethod || 'Desconhecido';
        const status = order.status || 'Pendente';

        // Aplicar filtros
        if (filterStatus !== 'all' && status !== filterStatus) return;
        if (filterMethod !== 'all' && method !== filterMethod) return;

        let subtotal = 0;
        const itemsHtml = order.items.map(item => {
          const itemTotal = (item.priceNew || 0) * (item.quantity || 1);
          subtotal += itemTotal;
          return `
            <p>${item.name || 'Produto desconhecido'} - Quantidade: ${item.quantity || 1} - ${formatCurrency(itemTotal)}</p>
          `;
        }).join('');

        const deliveryFee = order.purchaseData.address?.deliveryFee || 0;
        const totalWithDelivery = subtotal + deliveryFee;

        const address = order.purchaseData.address || {};
        const fullAddress = `
          <p>CEP: ${address.cep || 'Não informado'}</p>
          <p>Rua: ${address.street || 'Não informado'}</p>
          <p>Número: ${address.number || 'Não informado'}</p>
          <p>Complemento: ${address.complement || 'Não informado'}</p>
          <p>Bairro: ${address.neighborhood || 'Não informado'}</p>
          <p>Cidade: ${address.city || 'Não informado'}, ${address.state || 'Não informado'}</p>
        `;

        // Priorizar customerDetails para informações do cliente
        const customer = order.customerDetails || {};
        const clientName = customer.name || (order.paymentDetails?.cardName) || (order.pixDetails ? `${order.pixDetails.first_name || ''} ${order.pixDetails.last_name || ''}`.trim() : 'Convidado');
        const clientEmail = customer.email || order.paymentDetails?.email || order.pixDetails?.email || 'Não informado';
        const clientCPF = customer.cpf || order.paymentDetails?.cardCPF || order.pixDetails?.identification?.number || 'Não informado';

        let paymentDetailsHtml = '';
        if (method === 'Cartão' && order.paymentDetails) {
          const formattedCPF = formatCPF(order.paymentDetails.cardCPF || clientCPF);
          const formattedCardNumber = formatCardNumber(order.paymentDetails.cardNumber || '');
          paymentDetailsHtml = `
            <p><strong>Método:</strong> Cartão</p>
            <p><strong>Nome:</strong> ${order.paymentDetails.cardName || clientName}</p>
            <p><strong>E-mail:</strong> ${clientEmail}</p>
            <p><strong>CPF:</strong> ${formattedCPF}</p>
            <p><strong>Número do Cartão:</strong> ${formattedCardNumber}</p>
            <p><strong>Validade:</strong> ${order.paymentDetails.expMonth || ''}/${order.paymentDetails.expYear || ''}</p>
            <p><strong>CVV:</strong> ${order.paymentDetails.cvv || 'Não informado'}</p>
            <p><strong>Valor:</strong> ${formatCurrency(order.paymentDetails.transactionAmount || totalWithDelivery)}</p>
          `;
        } else if (method === 'Pix' && order.pixDetails) {
          const formattedCPF = formatCPF(order.pixDetails.identification?.number || clientCPF);
          paymentDetailsHtml = `
            <p><strong>Método:</strong> Pix</p>
            <p><strong>Nome:</strong> ${clientName}</p>
            <p><strong>E-mail:</strong> ${clientEmail}</p>
            <p><strong>CPF:</strong> ${formattedCPF}</p>
            <p><strong>Código Pix:</strong> <code>${order.pixDetails.qrCode || 'Não informado'}</code></p>
            <p><strong>Valor:</strong> ${formatCurrency(order.pixDetails.amount || totalWithDelivery)}</p>
          `;
        } else {
          paymentDetailsHtml = `<p>Detalhes do pagamento não disponíveis.</p>`;
        }

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>#${index + 1}</td>
          <td><a href="mailto:${clientEmail}">${clientName} (${clientEmail})</a></td>
          <td>
            <div class="order-items">
              ${itemsHtml}
            </div>
          </td>
          <td>
            <div class="address-details">
              ${fullAddress}
            </div>
          </td>
          <td>${formatCurrency(totalWithDelivery)}</td>
          <td>
            <div class="payment-details">
              ${paymentDetailsHtml}
            </div>
          </td>
          <td>${formatDate(order.orderDate)}</td>
          <td>${status}</td>
          <td>
            <button onclick="openEditOrderModal(${index})" aria-label="Editar pedido"><i class="fas fa-edit"></i> Editar</button>
            <button onclick="removeOrder(${index})" aria-label="Remover pedido"><i class="fas fa-trash"></i> Remover</button>
          </td>
        `;
        orderList.appendChild(row);
      });
    }

    // Função para abrir o modal de edição de pedido
    function openEditOrderModal(index) {
      const adminOrders = JSON.parse(localStorage.getItem('adminOrders')) || [];
      const order = adminOrders[index];
      if (!order) return;

      document.getElementById('edit-order-index').value = index;
      document.getElementById('edit-order-status').value = order.status || 'Pendente';
      openModal('edit-order-modal');
    }

    // Função para salvar alterações no pedido
    function saveOrderChanges() {
      const index = parseInt(document.getElementById('edit-order-index').value);
      const newStatus = document.getElementById('edit-order-status').value;
      const adminOrders = JSON.parse(localStorage.getItem('adminOrders')) || [];

      if (adminOrders[index]) {
        adminOrders[index].status = newStatus;
        saveOrders(adminOrders);
        closeModal('edit-order-modal');
      }
    }

    // Função para remover um pedido
    function removeOrder(index) {
      if (confirm('Tem certeza que deseja remover este pedido?')) {
        const adminOrders = JSON.parse(localStorage.getItem('adminOrders')) || [];
        adminOrders.splice(index, 1);
        saveOrders(adminOrders);
      }
    }

    // Função para abrir o modal
    function openModal(modalId) {
      document.getElementById(modalId).style.display = 'flex';
    }

    // Função para fechar o modal
    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
      if (modalId === 'add-product-modal') {
        document.getElementById('product-name').value = '';
        document.getElementById('product-description').value = '';
        document.getElementById('product-full-description').value = '';
        document.getElementById('product-notes').value = '';
        document.getElementById('product-price-total').value = '';
        document.getElementById('product-price-new').value = '';
        document.getElementById('product-delivery-option1').value = '';
        document.getElementById('product-delivery-option2').value = '';
        document.getElementById('product-image-file').value = '';
        document.getElementById('product-image-preview').style.display = 'none';
        clearProductErrors('product');
      } else if (modalId === 'add-client-modal') {
        document.getElementById('client-name').value = '';
        document.getElementById('client-email').value = '';
        document.getElementById('client-phone').value = '';
        document.getElementById('client-address').value = '';
        document.getElementById('client-purchases').value = '';
        clearClientErrors();
      }
    }

    // Função para limpar mensagens de erro do modal de produto
    function clearProductErrors(prefix) {
      const fields = [
        'product-name', 'product-description', 'product-full-description',
        'product-notes', 'product-price-total', 'product-price-new',
        'product-delivery-option1', 'product-delivery-option2', 'product-image-file'
      ];
      fields.forEach(field => {
        const input = document.getElementById(field);
        const error = document.getElementById(`error-${field}`);
        input.classList.remove('invalid');
        error.classList.remove('visible');
        error.textContent = '';
      });
    }

    // Função para limpar mensagens de erro do modal de cliente
    function clearClientErrors() {
      const fields = ['client-name', 'client-email', 'client-phone', 'client-address', 'client-purchases'];
      fields.forEach(field => {
        const input = document.getElementById(field);
        const error = document.getElementById(`error-${field}`);
        input.classList.remove('invalid');
        error.classList.remove('visible');
        error.textContent = '';
      });
    }

    // Função para pré-visualizar a imagem selecionada no modal de adição
    document.getElementById('product-image-file').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const error = document.getElementById('error-product-image-file');
      if (file && file.type === 'image/png') {
        const reader = new FileReader();
        reader.onload = function(e) {
          const preview = document.getElementById('product-image-preview');
          preview.src = e.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
        event.target.classList.remove('invalid');
        error.classList.remove('visible');
        error.textContent = '';
      } else {
        event.target.classList.add('invalid');
        error.textContent = 'Por favor, selecione um arquivo no formato PNG.';
        error.classList.add('visible');
        event.target.value = '';
      }
    });

    // Função para validar e adicionar um produto
    function addProduct() {
      const name = document.getElementById('product-name').value.trim();
      const description = document.getElementById('product-description').value.trim();
      const fullDescription = document.getElementById('product-full-description').value.trim();
      const notes = document.getElementById('product-notes').value.trim();
      const priceTotal = parseFloat(document.getElementById('product-price-total').value);
      const priceNew = parseFloat(document.getElementById('product-price-new').value);
      const deliveryOption1 = parseFloat(document.getElementById('product-delivery-option1').value);
      const deliveryOption2 = parseFloat(document.getElementById('product-delivery-option2').value);
      const imageFile = document.getElementById('product-image-file').files[0];

      let isValid = true;
      clearProductErrors('product');

      if (!name || name.length < 3) {
        document.getElementById('product-name').classList.add('invalid');
        document.getElementById('error-product-name').textContent = 'O nome deve ter pelo menos 3 caracteres.';
        document.getElementById('error-product-name').classList.add('visible');
        isValid = false;
      }
      if (!description || description.length < 5) {
        document.getElementById('product-description').classList.add('invalid');
        document.getElementById('error-product-description').textContent = 'A descrição curta deve ter pelo menos 5 caracteres.';
        document.getElementById('error-product-description').classList.add('visible');
        isValid = false;
      }
      if (!fullDescription || fullDescription.length < 10) {
        document.getElementById('product-full-description').classList.add('invalid');
        document.getElementById('error-product-full-description').textContent = 'A descrição completa deve ter pelo menos 10 caracteres.';
        document.getElementById('error-product-full-description').classList.add('visible');
        isValid = false;
      }
      if (!notes || !notes.includes('<br>')) {
        document.getElementById('product-notes').classList.add('invalid');
        document.getElementById('error-product-notes').textContent = 'As notas devem ser separadas por <br>.';
        document.getElementById('error-product-notes').classList.add('visible');
        isValid = false;
      }
      if (isNaN(priceTotal) || priceTotal <= 0) {
        document.getElementById('product-price-total').classList.add('invalid');
        document.getElementById('error-product-price-total').textContent = 'O preço total deve ser um valor positivo.';
        document.getElementById('error-product-price-total').classList.add('visible');
        isValid = false;
      }
      if (isNaN(priceNew) || priceNew <= 0) {
        document.getElementById('product-price-new').classList.add('invalid');
        document.getElementById('error-product-price-new').textContent = 'O preço promocional deve ser um valor positivo.';
        document.getElementById('error-product-price-new').classList.add('visible');
        isValid = false;
      }
      if (isNaN(deliveryOption1) || deliveryOption1 < 0) {
        document.getElementById('product-delivery-option1').classList.add('invalid');
        document.getElementById('error-product-delivery-option1').textContent = 'A taxa de entrega (Opção 1) deve ser um valor não negativo.';
        document.getElementById('error-product-delivery-option1').classList.add('visible');
        isValid = false;
      }
      if (isNaN(deliveryOption2) || deliveryOption2 < 0) {
        document.getElementById('product-delivery-option2').classList.add('invalid');
        document.getElementById('error-product-delivery-option2').textContent = 'A taxa de entrega (Opção 2) deve ser um valor não negativo.';
        document.getElementById('error-product-delivery-option2').classList.add('visible');
        isValid = false;
      }
      if (!imageFile) {
        document.getElementById('product-image-file').classList.add('invalid');
        document.getElementById('error-product-image-file').textContent = 'Por favor, selecione uma imagem PNG.';
        document.getElementById('error-product-image-file').classList.add('visible');
        isValid = false;
      }

      if (!isValid) return;

      const installmentsPerUnit = priceNew / 6;

      const reader = new FileReader();
      reader.onload = function(e) {
        const newProduct = {
          id: name.toLowerCase().replace(/\s+/g, '-'),
          name,
          description,
          fullDescription,
          notes,
          priceOld: priceTotal,
          priceNew: priceNew,
          installmentsPerUnit: installmentsPerUnit,
          image: e.target.result,
          deliveryFees: {
            sp: { option1: deliveryOption1, option2: deliveryOption2 },
            southeast: { option1: deliveryOption1, option2: deliveryOption2 },
            other: { option1: deliveryOption1, option2: deliveryOption2 }
          }
        };
        products.push(newProduct);
        saveProducts();
        closeModal('add-product-modal');
      };
      reader.readAsDataURL(imageFile);
    }

    // Função para adicionar um cliente
    function addClient() {
      const name = document.getElementById('client-name').value.trim();
      const email = document.getElementById('client-email').value.trim();
      const phone = document.getElementById('client-phone').value.trim();
      const address = document.getElementById('client-address').value.trim();
      const purchases = document.getElementById('client-purchases').value.trim();

      let isValid = true;
      clearClientErrors();

      if (!name || name.length < 3) {
        document.getElementById('client-name').classList.add('invalid');
        document.getElementById('error-client-name').textContent = 'O nome deve ter pelo menos 3 caracteres.';
        document.getElementById('error-client-name').classList.add('visible');
        isValid = false;
      }
      if (!email || !email.includes('@')) {
        document.getElementById('client-email').classList.add('invalid');
        document.getElementById('error-client-email').textContent = 'Por favor, insira um e-mail válido.';
        document.getElementById('error-client-email').classList.add('visible');
        isValid = false;
      }
      if (!phone || phone.length < 10) {
        document.getElementById('client-phone').classList.add('invalid');
        document.getElementById('error-client-phone').textContent = 'O telefone deve ter pelo menos 10 caracteres.';
        document.getElementById('error-client-phone').classList.add('visible');
        isValid = false;
      }
      if (!address || address.length < 5) {
        document.getElementById('client-address').classList.add('invalid');
        document.getElementById('error-client-address').textContent = 'O endereço deve ter pelo menos 5 caracteres.';
        document.getElementById('error-client-address').classList.add('visible');
        isValid = false;
      }
      if (!purchases || !/^\d+\s+pedido(s)?$/.test(purchases)) {
        document.getElementById('client-purchases').classList.add('invalid');
        document.getElementById('error-client-purchases').textContent = 'Use o formato "X pedidos", ex.: "3 pedidos".';
        document.getElementById('error-client-purchases').classList.add('visible');
        isValid = false;
      }

      if (!isValid) return;

      clients.push({
        name,
        email,
        phone,
        address,
        purchases
      });
      saveClients();
      closeModal('add-client-modal');
    }

    // Escutar mudanças no localStorage para atualizar a lista dinamicamente
    window.addEventListener('storage', function(event) {
      if (event.key === 'adminOrders') {
        console.log('Mudança detectada no localStorage para adminOrders:', event.newValue);
        updateOrderList();
        updateSummary();
      }
    });
  </script>
</body>
</html>
